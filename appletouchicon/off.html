<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no">
    <title>apple-touch-iconのてすと</title>
    <!-- <meta name="apple-mobile-web-app-capable" content="yes"> -->
    <meta name="apple-mobile-web-app-title" content="apple-touch-iconのてすと">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="./img/icon_a.png">
    <link rel="icon" type="image/vnd.microsoft.icon" href="./img/icon_a.png">
    <link id="apple-touch-icon" rel="apple-touch-icon" href="./img/icon_a.png">
    <script src="./js/lib/js.cookie.js"></script>
    <script>
      var icon_a = "./img/icon_a.png"
      var icon_b = "./img/icon_b.png"
      var icon_c = "./img/icon_c.png"
      var icon = [icon_a, icon_b, icon_c];
      
      var index = +Cookies.get("ATIT-index") || 0;
      
      var appleTouchIcon = document.getElementById("apple-touch-icon");
      appleTouchIcon.href = icon[index];
      
      window.onload = function(){
        var iconImg = document.getElementById("icon-img");
        iconImg.src = icon[index];
      };
      
      var next = (index < icon.length - 1) ? index + 1 : 0;
      Cookies.set("ATIT-index", next, {expires: 7});
      
    </script>
    <style>
      body {
        font-family: Futura, YuGothic, Meiryo, Arial, sans-serif;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <h1 class="ttl">apple-touch-iconのてすと</h1>
      <p>apple-mobile-web-app-capableなし。</p>
      <img id="icon-img" src="">
      <p>
        apple-mobile-web-app-capableを設定するとホーム画面に追加したアイコンが更新されなくなっているっぽい。<br>
        iOS9.0.1とiOS8.4で確認。<br>
        <br>
        「ホーム画面に追加」して、アクセスしたり戻ったりして確認してください。<br>
        ホーム画面のアイコンの色とページ上の四角の色が、cookieを見て、アクセスするたびに変わる（３色をループする）ようになってますが、<br>
        apple-mobile-web-app-capableありのほう（アプリモードのほう）は、ホーム画面のアイコンが変わりません。<br>
        たしかiOS7のときはちゃんと動いてたはず。（たぶん）<br>
      </p>
      <p><a href="./">apple-mobile-web-app-capableあり。</a></p>
      <p><a href="./off.html">apple-mobile-web-app-capableなし。</a></p>
      <p>
        （なしのほうでも、アクセス後にページをリロードした時はホーム画面のアイコンに反映されないことに気付いた。）
      </p>
    </div>
  </body>
</html>
